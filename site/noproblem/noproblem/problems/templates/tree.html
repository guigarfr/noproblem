{% extends "base.html" %}

{% block title %}Connecta - NoProblem{% endblock %}

{% block content %}

{% load i18n %}
{% load custom_filters %}

<style type="text/css">

div {
	display: block;
}

#graph-wrapper{
	width: 100%;
}

.clear {
	clear:both;
}
</style>



{% if pr_dict %}
	{{ pr_dict }}
    <ul>
    {% for prob,v in pr_dict.items %}
        <li><a href="/problems/{{ prob.id }}/">{{ prob.title }} has {{ prob.get_children.count }} {{ prob.get_children.count|pluralize:"child,children" }}</a></li>
        {{ prob.title }} is to be in position ({{pr_dict|keyvalue:prob|lookup:0}} , {{pr_dict|keyvalue:prob|lookup:1}})
    {% endfor %}
    </ul>
{% else %}
    <p>No problems are available.</p>
{% endif %}

	{% for layer in layer_list %}
		{% with layer_list|length|add:-1 as nlayers %}
		{% for prob in layer %}
			{% set depth = forloop.parentloop.counter %}
			{% with nlayers|substract:depth|add:1 as thisdepth %}
				{{ prob.id }} in layer {{ depth }} has depth {{ pr_dict|keyvalue:prob|lookup:1 }} translate {{ pr_dict|keyvalue:prob|lookup:0|multiplyperfactor:40 }} and {{ pr_dict|keyvalue:prob|lookup:1|multiplyperfactor:35 }}<br/>
			{% endwith %}
		{% endfor %}
		{% endwith %}
	{% endfor %}
	
<div id="tree_wrapper">

<svg id="problem-tree" width="100%" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" ">
	<defs>
		<marker id='head' orient='auto' markerWidth='20' markerHeight='30'
				refX='20' refY='15'>
			<path d='M0,0 V30 L20,15 Z' fill='red' />
		</marker>
	</defs>
	
	{% for prob,v in pr_dict.items %}
	<g id="problem{{prob.id}}"
	   transform="translate({{ v|lookup:0|multiplyperfactor:450 }} {{ v|lookup:1|multiplyperfactor:140 }} )" 
	   class="node solved" data-content="Solved by 5651 (correct ratio 69.5%).&lt;p class=&quot;topics&quot;&gt;&lt;strong&gt;Topics&lt;/strong&gt;: &lt;span class=&quot;topic&quot;&gt;String Algorithms&lt;/span&gt;&lt;/p&gt;" rel="popover" data-original-title="“Counting DNA Nucleotides”">
		<a href="/problems/{{prob.id}}/">
			<ellipse fill="none" stroke="black" cx="80" cy="80" rx="70" ry="50"></ellipse>
			<text text-anchor="middle" x="80" y="80" font-family="Times Roman,serif" font-size="14.00">{{prob.title}}</text>
		</a>
	</g>
		{% for child in prob.get_children %}
	<g id="edge15" class="edge" >
		<path marker-end='url(#head)' stroke-width='0.5' fill='none' stroke='gray'
		d='M {{ v|lookup:0|multiplyperfactor:450|add:80 }},{{ v|lookup:1|multiplyperfactor:140|add:130 }}
			{{ pr_dict|keyvalue:child|lookup:0|multiplyperfactor:450|add:80 }} {{ pr_dict|keyvalue:child|lookup:1|multiplyperfactor:140|add:30 }}' />
		<circle transform="translate({{ v|lookup:0|multiplyperfactor:450 }} {{ v|lookup:1|multiplyperfactor:140 }} )" cx="80" cy="130" r="1" stroke="#000" stroke-width="1" />
		<circle transform="translate({{ pr_dict|keyvalue:child|lookup:0|multiplyperfactor:450 }} {{ pr_dict|keyvalue:child|lookup:1|multiplyperfactor:140 }} )"
		cx="80" cy="30" r="1" stroke="#ACA" stroke-width="1" />
	</g>
	{% endfor %}

{% endfor %}
		
	<g id="edge15" class="edge">
		<path marker-end='url(#head)' stroke-width='0.5' fill='none' stroke='gray' d='M 512,130 512,180' />
	</g>

</svg>
</div>



{% endblock %}